<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="initial-scale=1, width=device-width" />

  <link rel="stylesheet" href="../../../global.css" />
  <link rel="stylesheet" href="./HardIndex.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400&display=swap" />
</head>

<body>
    <div class="foreground">
      <div class="modeIndicator">
        <div class="buttonText" id="gamemode">Hard</div>
      </div>
      <div class="headingText" id="header">Song 1/5</div>
      <input class="textBox" type="text" id="textBox" placeholder="Enter BPM..."></input>
      <button class="button1" id="submitAns">Submit</button>
      
      <div class="guessText" id="guessCount">Correct Guesses: 0</div>
      <div class="infoText" id="hintPHolder" style="display: none;"> this is a placeholder for hints
        and to note that music is not yet implemeneted, for now see if you can guess the correct answer!
      </div>
      <img class="stop-and-play-duotone-icon" id="toggleMusic" alt="" src="../../../Assets/Stop_and_play_duotone.svg" />

      <img class="nextArrow" alt="" id="nextArr" src="../../../Assets/Right-Arrow.svg" hidden="" />
      
    </div>

    <script>
      var bpm_ans = Math.floor(Math.random() * (144 - 60 + 1)) + 60;
      var correct_guesses = 0;
      var question_num = 1;
      var numGuesses = 0;

      function isCorrect(subButton){
        
        subButton.addEventListener("click", function (e) {
            numGuesses++;
            if(/^[a-z]+$/i.test(document.getElementById('textBox').value ) == true){
              document.getElementById("textBox").value = null;
              document.getElementById('textBox').placeholder = 'must be a number!'
            }else if(document.getElementById('textBox').value  < 60 || document.getElementById('textBox').value > 144){
              document.getElementById("textBox").value = null;
              document.getElementById('textBox').placeholder = 'must be value betwen 60-144!'
            }else if(document.getElementById('textBox').value == bpm_ans){
              correct_guesses++;
              e.target.innerHTML = "Correct!"
              document.getElementById("guessCount").innerHTML =
              "Correct Guesses " + correct_guesses;
              document.getElementById("nextArr").removeAttribute("hidden");
              subButton.disabled = true;
            }else{
              e.target.innerHTML = "Answer: " + bpm_ans;
              document.getElementById("nextArr").removeAttribute("hidden");
              subButton.disabled = true;
            }

            
            
          });
        }

      const toggleMusic = document.getElementById("toggleMusic");
      const submitAns = document.getElementById("submitAns");
      const nextButton = document.getElementById("nextArr");

      if (toggleMusic) {
        toggleMusic.addEventListener("mouseover", function (e) {
            document.getElementById("hintPHolder").style.display = 'block';
        });
        toggleMusic.addEventListener("mouseout", function (e) {
            document.getElementById("hintPHolder").style.display = 'none';
        }); 

      }

      if (submitAns) {
        isCorrect(submitAns);
      }

      
      if (nextButton) {
        nextButton.addEventListener("click", function (e) {
          bpm_ans = Math.floor(Math.random() * (144 - 60 + 1)) + 60;
          submitAns.disabled = false;
          if (question_num + 1 > 5){
            
            localStorage.setItem('total-guesses', numGuesses);
            localStorage.setItem('correct-guesses', correct_guesses);
            localStorage.setItem('game-mode', document.getElementById('gamemode').innerHTML)
            window.location.href = './5.Results/Results.html'
          
          } else {

            question_num++;
            submitAns.innerHTML = "Submit"
            document.getElementById("textBox").value = null;
            document.getElementById("header").innerHTML = "Song " + question_num + "/5";
            document.getElementById("nextArr").setAttribute("hidden", "hidden");
          }
        });
      }
      
      
    </script>
</body>

</html>